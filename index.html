<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="StreamDay">
<title>StreamDay</title>
<style>
  :root {
    --bg:#000;--surface:#0f0f0f;--s2:#1c1c1e;--s3:#2c2c2e;
    --border:rgba(255,255,255,.08);--text:#fff;
    --t2:rgba(255,255,255,.6);--t3:rgba(255,255,255,.3);
    --r:14px;
    --font:-apple-system,"SF Pro Display",BlinkMacSystemFont,"Helvetica Neue",sans-serif;
  }
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  body{background:var(--bg);color:var(--text);font-family:var(--font);-webkit-font-smoothing:antialiased;overflow-x:hidden;min-height:100dvh}

  .sb{height:env(safe-area-inset-top,44px);background:rgba(0,0,0,.9);position:fixed;top:0;left:0;right:0;z-index:100}

  .nav{position:fixed;top:env(safe-area-inset-top,44px);left:0;right:0;z-index:99;height:54px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;background:rgba(0,0,0,.82);backdrop-filter:blur(30px);-webkit-backdrop-filter:blur(30px);border-bottom:.5px solid var(--border)}
  .logo{font-size:19px;font-weight:700;letter-spacing:-.6px}
  .logo span{color:var(--t2);font-weight:300}
  .pills{display:flex;gap:6px}
  .pill{padding:5px 13px;border-radius:20px;font-size:12px;font-weight:500;border:.5px solid var(--border);background:var(--s2);color:var(--t2);cursor:pointer;transition:all .2s;-webkit-tap-highlight-color:transparent}
  .pill.active{background:#fff;color:#000;border-color:#fff}

  /* Service chip row */
  .svc-bar{position:sticky;top:calc(env(safe-area-inset-top,44px) + 54px);z-index:98;display:flex;gap:8px;padding:10px 20px 10px;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;background:rgba(0,0,0,.82);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-bottom:.5px solid var(--border)}
  .svc-bar::-webkit-scrollbar{display:none}
  .svc-chip{flex:0 0 auto;display:flex;align-items:center;gap:5px;padding:5px 12px;border-radius:20px;font-size:11px;font-weight:600;border:.5px solid var(--border);background:var(--s2);color:var(--t2);cursor:pointer;-webkit-tap-highlight-color:transparent;white-space:nowrap;transition:all .2s}
  .svc-chip.active{color:#fff;border-color:rgba(255,255,255,.35);background:var(--s3)}
  .chip-dot{width:7px;height:7px;border-radius:50%;flex:0 0 auto}

  .main{padding-top:calc(env(safe-area-inset-top,44px) + 54px + 52px + 10px);padding-bottom:calc(env(safe-area-inset-bottom,20px) + 30px)}

  /* Loading screen */
  .loading-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:60vh;gap:16px}
  .spinner{width:36px;height:36px;border:2.5px solid var(--s3);border-top-color:#fff;border-radius:50%;animation:spin .8s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  .loading-text{font-size:14px;color:var(--t3);letter-spacing:.3px}

  .day-section{margin-bottom:28px;animation:fadeUp .4s ease both}
  @keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

  .day-header{padding:0 20px 4px;display:flex;align-items:center;gap:8px}
  .day-name{font-size:22px;font-weight:700;letter-spacing:-.5px}
  .today-chip{font-size:11px;font-weight:600;color:#000;background:#fff;border-radius:6px;padding:2px 8px}
  .day-sub{padding:0 20px 14px;font-size:13px;color:var(--t3)}
  .cat-row{padding:2px 20px 10px;font-size:11px;font-weight:600;letter-spacing:.8px;text-transform:uppercase;color:var(--t3)}
  .divider{height:.5px;background:var(--border);margin:0 20px 24px}

  .scroll-track{display:flex;gap:12px;padding:0 20px 6px;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none}
  .scroll-track::-webkit-scrollbar{display:none}

  .card{flex:0 0 auto;width:124px;cursor:pointer;-webkit-tap-highlight-color:transparent;transition:transform .18s}
  .card:active{transform:scale(.95)}
  .card-poster{width:124px;height:184px;border-radius:var(--r);overflow:hidden;position:relative;background:var(--s2);margin-bottom:8px;box-shadow:0 4px 16px rgba(0,0,0,.55)}
  .card-poster img{width:100%;height:100%;object-fit:cover;display:block}
  .fallback{width:100%;height:100%;display:flex;align-items:flex-end;padding:10px;background:linear-gradient(145deg,#1a1a2e,#16213e)}
  .fallback span{font-size:11px;font-weight:700;color:rgba(255,255,255,.9);line-height:1.3}
  .badge{position:absolute;top:7px;right:7px;border-radius:6px;padding:3px 7px;font-size:9px;font-weight:800;letter-spacing:.2px;text-transform:uppercase;border:.5px solid rgba(255,255,255,.15);white-space:nowrap}
  .new-label{position:absolute;top:7px;left:7px;background:#FF375F;color:#fff;font-size:9px;font-weight:700;padding:2px 6px;border-radius:5px;text-transform:uppercase}
  .card-title{font-size:12px;font-weight:600;line-height:1.3;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .card-meta{font-size:11px;color:var(--t3);margin-top:2px}
  .day-empty{padding:4px 20px 14px;font-size:13px;color:var(--t3)}

  /* Modal */
  .overlay{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,.6);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);opacity:0;pointer-events:none;transition:opacity .28s;display:flex;align-items:flex-end}
  .overlay.open{opacity:1;pointer-events:all}
  .sheet{width:100%;background:var(--surface);border-radius:22px 22px 0 0;padding:10px 0 calc(env(safe-area-inset-bottom,20px) + 20px);transform:translateY(100%);transition:transform .38s cubic-bezier(.32,.72,0,1);max-height:85dvh;overflow-y:auto}
  .overlay.open .sheet{transform:translateY(0)}
  .handle{width:36px;height:4px;background:rgba(255,255,255,.18);border-radius:2px;margin:0 auto 18px}
  .si{padding:0 20px;display:flex;gap:16px}
  .sp{width:104px;height:152px;border-radius:12px;overflow:hidden;flex:0 0 auto;box-shadow:0 8px 28px rgba(0,0,0,.65);background:var(--s2)}
  .sp img{width:100%;height:100%;object-fit:cover;display:block}
  .sinf{flex:1;min-width:0}
  .ssvc{font-size:11px;font-weight:600;letter-spacing:.5px;text-transform:uppercase;margin-bottom:5px}
  .stitle{font-size:18px;font-weight:700;letter-spacing:-.3px;line-height:1.2;margin-bottom:4px}
  .smeta{font-size:12px;color:var(--t3);margin-bottom:10px}
  .stags{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:8px}
  .stag{font-size:11px;font-weight:500;padding:3px 9px;border-radius:7px;background:var(--s3);color:var(--t2)}
  .srating{font-size:12px;color:var(--t3)}
  .sdesc{padding:16px 20px 0;font-size:13px;color:var(--t2);line-height:1.65}
  .watch-btn{display:flex;align-items:center;justify-content:center;gap:8px;width:calc(100% - 40px);margin:18px 20px 0;height:50px;border-radius:14px;background:#fff;color:#000;font-size:15px;font-weight:600;border:none;cursor:pointer;text-decoration:none;-webkit-tap-highlight-color:transparent;transition:opacity .2s}
  .watch-btn:active{opacity:.72}
</style>
</head>
<body>
<div class="sb"></div>
<nav class="nav">
  <div class="logo">Stream<span>Day</span></div>
  <div class="pills">
    <div class="pill active" data-f="all"   onclick="setTypeFilter(this)">All</div>
    <div class="pill"        data-f="movie" onclick="setTypeFilter(this)">Movies</div>
    <div class="pill"        data-f="tv"    onclick="setTypeFilter(this)">Series</div>
  </div>
</nav>

<!-- Service filter bar (populated after load) -->
<div class="svc-bar" id="svcBar">
  <div class="svc-chip active" data-id="all" onclick="setSvc(this)">All Services</div>
</div>

<main class="main" id="main">
  <div class="loading-screen">
    <div class="spinner"></div>
    <div class="loading-text">Loading streaming releasesâ€¦</div>
  </div>
</main>

<div class="overlay" id="overlay" onclick="closeIfBg(event)">
  <div class="sheet">
    <div class="handle"></div>
    <div class="si" id="si"></div>
    <div class="sdesc" id="sd"></div>
    <a class="watch-btn" id="wb" href="#" target="_blank">â–¶&nbsp;&nbsp;Watch Now</a>
  </div>
</div>

<script>
// â”€â”€â”€ PROVIDERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Each entry: id, name, color, text color
// We query each of these individually for best coverage
const SVCS = [
  { id: 8,    name: 'Netflix',      color: '#E50914', text: '#fff' },
  { id: 9,    name: 'Prime Video',  color: '#00A8E0', text: '#fff' },
  { id: 337,  name: 'Disney+',     color: '#113CCF', text: '#fff' },
  { id: 350,  name: 'Apple TV+',   color: '#666',    text: '#fff' },
  { id: 1899, name: 'Max',          color: '#5822B4', text: '#fff' },
  { id: 531,  name: 'Paramount+',  color: '#0064FF', text: '#fff' },
  { id: 15,   name: 'Hulu',         color: '#1CE783', text: '#000' },
  { id: 29,   name: 'Videoland',    color: '#E00000', text: '#fff' },
];

const SVC_MAP = {};
SVCS.forEach(s => SVC_MAP[s.id] = s);

const BEARER = 'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJiZWI4MDVlODg2MmYyODhkOTQ1NDhmOTU1NGYyZjc2YiIsIm5iZiI6MTY3OTQ3MzE2Ni43NzMsInN1YiI6IjY0MWFiYTBlZjlhYTQ3MDBiMTUxZGRmYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.E73D999tD0DBX0aJVVfyooRa3T750C-Y_Hk1TZLr-EM';
const BASE = 'https://api.themoviedb.org/3';
const IMG  = 'https://image.tmdb.org/t/p/w300';

// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let allItems  = []; // all enriched items fetched
let typeFilter = 'all';
let svcFilter  = 'all';
const detailCache = {};

// â”€â”€â”€ API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function api(path, params = {}) {
  const url = new URL(BASE + path);
  Object.entries(params).forEach(([k,v]) => url.searchParams.set(k,v));
  const r = await fetch(url.toString(), {
    headers: { Authorization: `Bearer ${BEARER}`, Accept: 'application/json' }
  });
  if (!r.ok) throw new Error(r.status);
  return r.json();
}

// â”€â”€â”€ DATE HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function today()  { return new Date().toISOString().slice(0,10); }
function addDays(dateStr, n) {
  const d = new Date(dateStr);
  d.setDate(d.getDate() + n);
  return d.toISOString().slice(0,10);
}
function formatDayName(dateStr) {
  const d = new Date(dateStr + 'T12:00:00');
  return d.toLocaleDateString('en-GB', { weekday: 'long' });
}
function formatFullDate(dateStr) {
  const d = new Date(dateStr + 'T12:00:00');
  return d.toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });
}
function isToday(dateStr) { return dateStr === today(); }

// â”€â”€â”€ FETCH ALL PROVIDERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// For each service, fetch movies + TV released in last 60 days â†’ next 14 days
// This wide window ensures we catch everything regardless of TMDB date lag
async function fetchAllProviders() {
  const from = addDays(today(), -60);
  const to   = addDays(today(), 14);

  const results = [];

  for (const svc of SVCS) {
    // Try NL first, then US region
    for (const region of ['NL', 'US']) {
      const base = {
        with_watch_providers: String(svc.id),
        watch_region: region,
        with_watch_monetization_types: 'flatrate',
        sort_by: 'primary_release_date.desc',
        page: 1,
      };

      try {
        const [mRes, tRes] = await Promise.all([
          api('/discover/movie', { ...base, 'primary_release_date.gte': from, 'primary_release_date.lte': to }),
          api('/discover/tv',   { ...base, sort_by: 'first_air_date.desc', 'first_air_date.gte': from, 'first_air_date.lte': to }),
        ]);

        (mRes.results || []).forEach(item => {
          results.push({
            ...item,
            _type: 'movie',
            _date: item.release_date || item.primary_release_date || '',
            _svc: svc,
            _region: region,
          });
        });

        (tRes.results || []).forEach(item => {
          results.push({
            ...item,
            _type: 'tv',
            _date: item.first_air_date || '',
            _svc: svc,
            _region: region,
          });
        });

        // If we got results from NL, skip US for this provider
        if ((mRes.results?.length || 0) + (tRes.results?.length || 0) > 0) break;

      } catch(e) {
        console.warn(`Failed ${svc.name} ${region}:`, e);
      }
    }
  }

  // Deduplicate: keep one entry per (id, type) â€” prefer NL over US
  const seen = new Map();
  const deduped = [];
  for (const item of results) {
    const key = `${item._type}-${item.id}`;
    if (!seen.has(key)) {
      seen.set(key, true);
      deduped.push(item);
    }
  }

  return deduped;
}

// â”€â”€â”€ GROUP BY DATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function groupByDate(items) {
  const map = {};
  items.forEach(item => {
    const d = item._date;
    if (!d) return;
    if (!map[d]) map[d] = { movies: [], tv: [] };
    if (item._type === 'movie') map[d].movies.push(item);
    else map[d].tv.push(item);
  });
  return map;
}

// â”€â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function applyFilters(items) {
  return items.filter(item => {
    if (typeFilter === 'movie' && item._type !== 'movie') return false;
    if (typeFilter === 'tv'    && item._type !== 'tv')    return false;
    if (svcFilter !== 'all' && item._svc.id != svcFilter) return false;
    return true;
  });
}

function renderAll() {
  const main = document.getElementById('main');
  main.innerHTML = '';

  const filtered = applyFilters(allItems);
  const grouped  = groupByDate(filtered);

  // Show today + next 7 days only
  const start = today();
  const days  = Array.from({ length: 8 }, (_, i) => addDays(start, i));

  let anyContent = false;

  days.forEach((dateStr, i) => {
    const data = grouped[dateStr];
    const movies = data?.movies || [];
    const tv     = data?.tv     || [];

    if (!movies.length && !tv.length) return;
    anyContent = true;

    const section = document.createElement('section');
    section.className = 'day-section';
    section.style.animationDelay = `${i * 0.04}s`;

    const todayChip = isToday(dateStr) ? '<span class="today-chip">Today</span>' : '';

    let html = `
      <div class="day-header">
        <div class="day-name">${formatDayName(dateStr)}</div>
        ${todayChip}
      </div>
      <div class="day-sub">${formatFullDate(dateStr)}</div>
    `;

    if (movies.length) {
      html += `<div class="cat-row">ğŸ¬ &nbsp;Movies</div>
               <div class="scroll-track">${movies.map(m => makeCard(m)).join('')}</div>`;
    }
    if (tv.length) {
      html += `<div class="cat-row">ğŸ“º &nbsp;TV Series</div>
               <div class="scroll-track">${tv.map(t => makeCard(t)).join('')}</div>`;
    }

    if (i < days.length - 1) html += '<div class="divider"></div>';

    section.innerHTML = html;
    main.appendChild(section);
  });

  if (!anyContent) {
    main.innerHTML = `<div class="loading-screen"><div class="loading-text">No releases found for the selected filters.</div></div>`;
  }
}

function makeCard(item) {
  const title = (item.title || item.name || '').replace(/'/g,"&#39;").replace(/"/g,'&quot;');
  const p = item._svc;
  const img = item.poster_path
    ? `<img src="${IMG}${item.poster_path}" alt="${title}" loading="lazy">`
    : `<div class="fallback"><span>${title}</span></div>`;
  const badge = `<div class="badge" style="background:${p.color}cc;color:${p.text}">${p.name}</div>`;
  const meta  = item.vote_average > 0 ? `â­ ${item.vote_average.toFixed(1)}` : (item._type === 'movie' ? 'Movie' : 'Series');

  return `<div class="card" onclick="openModal(${item.id},'${item._type}')">
    <div class="card-poster">${img}<div class="new-label">New</div>${badge}</div>
    <div class="card-title">${title}</div>
    <div class="card-meta">${meta}</div>
  </div>`;
}

// â”€â”€â”€ SERVICE FILTER BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildSvcBar() {
  const bar = document.getElementById('svcBar');
  // Which services actually have results?
  const foundIds = new Set(allItems.map(i => i._svc.id));
  const found = SVCS.filter(s => foundIds.has(s.id));

  bar.innerHTML = `<div class="svc-chip active" data-id="all" onclick="setSvc(this)">All Services</div>`;
  found.forEach(s => {
    bar.innerHTML += `<div class="svc-chip" data-id="${s.id}" onclick="setSvc(this)">
      <div class="chip-dot" style="background:${s.color}"></div>${s.name}
    </div>`;
  });
}

// â”€â”€â”€ FILTERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setTypeFilter(el) {
  typeFilter = el.dataset.f;
  document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
  el.classList.add('active');
  renderAll();
}

function setSvc(el) {
  svcFilter = el.dataset.id;
  document.querySelectorAll('.svc-chip').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  renderAll();
}

// â”€â”€â”€ MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function openModal(id, type) {
  const overlay = document.getElementById('overlay');
  const si = document.getElementById('si');
  const sd = document.getElementById('sd');
  const wb = document.getElementById('wb');

  si.innerHTML = `<div class="sp" style="background:var(--s2)"></div>
    <div class="sinf"><div style="height:10px;width:50%;background:var(--s3);border-radius:6px;margin-bottom:12px"></div>
    <div style="height:16px;width:90%;background:var(--s3);border-radius:6px;margin-bottom:8px"></div>
    <div style="height:10px;width:65%;background:var(--s3);border-radius:6px"></div></div>`;
  sd.textContent = '';
  wb.style.display = 'none';
  overlay.classList.add('open');
  document.body.style.overflow = 'hidden';

  const key = `${type}-${id}`;
  if (!detailCache[key]) {
    try {
      const [d, wp] = await Promise.all([
        api(`/${type}/${id}`),
        api(`/${type}/${id}/watch/providers`),
      ]);
      let provider = null, link = null;
      for (const region of ['NL','US']) {
        const reg = wp.results?.[region] || {};
        if (!provider) {
          const flat = reg.flatrate || [];
          for (const p of flat) {
            if (SVC_MAP[p.provider_id]) { provider = SVC_MAP[p.provider_id]; break; }
          }
        }
        if (!link) link = reg.link || null;
      }
      detailCache[key] = { d, provider, link };
    } catch {
      si.innerHTML = `<div style="padding:10px;color:var(--t2)">Could not load details.</div>`;
      return;
    }
  }

  const { d, provider: p, link } = detailCache[key];
  const title  = d.title || d.name || 'â€”';
  const poster = d.poster_path ? `<img src="${IMG}${d.poster_path}" alt="">` : `<div class="fallback"><span>${title}</span></div>`;
  const year   = (d.release_date || d.first_air_date || '').slice(0,4);
  const rt     = d.runtime ? `${d.runtime} min` : (d.episode_run_time?.[0] ? `${d.episode_run_time[0]} min/ep` : '');
  const genres = (d.genres||[]).slice(0,3).map(g=>`<span class="stag">${g.name}</span>`).join('');
  const rating = d.vote_average > 0 ? `<span style="color:#FFD60A">â˜…</span> ${d.vote_average.toFixed(1)} / 10` : '';

  si.innerHTML = `
    <div class="sp">${poster}</div>
    <div class="sinf">
      <div class="ssvc" style="color:${p?.color||'#888'}">${p?.name||'Streaming'}</div>
      <div class="stitle">${title}</div>
      <div class="smeta">${type==='movie'?'ğŸ¬ Movie':'ğŸ“º TV Series'}${year?' Â· '+year:''}${rt?' Â· '+rt:''}</div>
      <div class="stags">${genres}</div>
      ${rating?`<div class="srating">${rating}</div>`:''}
    </div>`;
  sd.textContent = d.overview || 'No description available.';

  if (link) { wb.href = link; wb.style.display = 'flex'; }
}

function closeIfBg(e) {
  if (e.target === document.getElementById('overlay')) {
    document.getElementById('overlay').classList.remove('open');
    document.body.style.overflow = '';
  }
}

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function init() {
  try {
    allItems = await fetchAllProviders();
    buildSvcBar();
    renderAll();
  } catch(e) {
    document.getElementById('main').innerHTML =
      `<div class="loading-screen"><div class="loading-text">Failed to load. Check your connection and try again.</div></div>`;
  }
}

init();
</script>
</body>
</html>
